<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MrrfyW</title>
<meta name="description" content="A simple landing page.">
<meta name="keywords" content="MrrfyW, pokemon, furret, incineroar, haunter, whimsicle, lenored, lenored royle, Other K, mrfurretgo">
<meta property="og:title" content="MrrfyW!">
<meta property="og:description" content="A simple landing page.">
<meta property="og:image" content="https://MrrfyW.github.io/images/embedImage.webp">
<meta property="og:url" content="https://MrrfyW.github.io">
<meta name="theme-color" content="#C94B4B">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="MrrfyW!">
<meta name="twitter:description" content="A simple landing page.">
<meta name="twitter:image" content="https://mrrfyw.github.io/images/embedImage.webp">
<link rel="icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden; /* Prevent scrollbars if content slightly overflows */
  }
  .container {
    position: relative;
    width: 100%;
    height: 100%;
  }
  .background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }
  .logo {
    position: absolute;
    top: 47.5%;
    left: 50%;
    transform: translate(-50%, -35%);
    width: 50%;
    max-width: 50%; /* half of logo width */
    z-index: 2;
  }
  .left-image {
    position: absolute;
    top: 48.5%; /* Center vertically */
    left: calc(50% - 35.5%); /* Positions at 15% left of the logo width */
    max-width: 20%;
    transform: translateY(-50%);
    transition: transform 0.5s ease;
    z-index: 1;
  }
  .right-image {
    position: absolute;
    top: 47.5%; /* Center vertically */
    right: calc(50% - 35.5%); /* Positions at 15% right of the logo width */
    max-width: 15%;
    transform: translateY(-50%);
    transition: transform 0.5s ease;
    z-index: 1;
  }
  .music-button {
    position: fixed; /* Changed to fixed */
    bottom: 2.5%; /* Offset from the bottom */
    left: 2.5%; /* Offset from the left */
    max-width: 7.5%; /* Scalable size */
    z-index: 3; /* Ensure it's above other elements */
    cursor: pointer; /* Indicate it's clickable */
  }
  .music-info {
    position: fixed; /* Changed to fixed */
    bottom: 2.5%; /* Offset from the bottom */
    left: 11.5%; /* Offset from the left */
    /* Removed transform: translateY(-100%); to align better with fixed button */
    width: auto; /* Adjust width as needed */
    z-index: 3; /* Ensure it's above other elements */
  }
  #track-name {
    font-family: Arial, sans-serif; /* Specify the desired font family */
    font-size: 2vw; /* Adjust the font size as needed */
    color: #ffffff; /* Set the text color */
    margin: 0; /* Remove default margin */
    text-shadow: -1px -1px 0 #000,
                  1px -1px 0 #000,
                 -1px 1px 0 #000,
                  1px 1px 0 #000; /* Black outline */
    white-space: nowrap; /* Prevent text wrapping */
  }
  #track-name a {
    color: #ffffff; /* Set the link color */
    text-decoration: none; /* Remove underline from the link */
  }
  #track-name a:hover {
    text-decoration: underline; /* Add underline on hover */
  }
  /* Container styling adjusted for centering absolute elements */
  .container {
    /* Removed flex properties as absolute positioning is used */
    height: 100%;
    position: relative;
  }
  .about-image, .find-image, .projects-image {
    position: absolute;
    top: 47.5%;
    width: 30%;
    max-width: 15%;
    z-index: 3;
  }
  .about-image {
    left: 35%;
    transform: translate(-50%, 125%);
  }
  .find-image {
    left: 50%;
    transform: translate(-50%, 35%);
  }
  .projects-image {
    left: 65%;
    transform: translate(-50%, 125%);
  }
  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: black;
    z-index: 9999; /* Ensure it's on top of other content */
    opacity: 1; /* Initially fully opaque */
    transition: opacity 0.5s; /* Apply a 0.5s transition for opacity */
    pointer-events: none; /* Allow clicks through after fade */
  }
  .characterlist-image {
    position: absolute;
    left: 50%; /* Center horizontally */
    transform: translate(-50%, 275%); /* Adjust position under the previous three buttons */
    width: 30%;
    max-width: 15%;
    z-index: 3;
  }

  /* Style for the Neocities badge */
  .neocities-badge {
    position: fixed; /* Position relative to the viewport */
    bottom: 2.5%;    /* Distance from the bottom */
    right: 2.5%;     /* Distance from the right */
    max-width: 100px;  /* Control the size (adjust as needed) */
    width: auto;       /* Maintain aspect ratio */
    height: auto;      /* Maintain aspect ratio */
    border: 3px solid black; /* Black outline */
    box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.6); /* Add shadow */
    z-index: 3;      /* Ensure it's above background, same level as music button */
  }
</style>
</head>
<body>
  <div class="overlay"></div> <!-- Overlay should be first for z-index behavior -->

  <div class="container">
    <img class="background" src="images/background.webp" alt="Background">
    <a href="3DS/index.html">
      <img class="logo" src="images/Logo.webp" alt="Click if 3DS User">
    </a>
    <img class="left-image" src="images/Lenored1.webp" alt="Left Image">
    <img class="right-image" src="images/Whimsicle1.webp" alt="Right Image">
    <a href="https://MrrfyW.github.io/aboutme/">
      <img class="about-image" src="images/aboutme.webp" alt="About Me">
    </a>
    <a href="https://MrrfyW.github.io/wheretofindme/">
      <img class="find-image" src="images/wheretofind.webp" alt="Where to Find Me">
    </a>
    <a href="https://MrrfyW.github.io/projects/">
      <img class="projects-image" src="images/projects.webp" alt="Projects">
    </a>
    <a href="https://MrrfyW.github.io/characterlist/">
      <img class="characterlist-image" src="images/characters.webp" alt="Character List">
    </a>
    <!-- Music elements moved outside container for fixed positioning to work reliably -->
  </div>

  <!-- Music Button and Info placed outside the relatively positioned container -->
  <img class="music-button" src="images/music_off.webp" alt="Music Button">
  <div class="music-info" style="display: none;">
      <p id="track-name"><a href="#" id="music-link" target="_blank"></a></p>
  </div>

  <!-- Neocities Badge added here -->
  <a href="https://mrrfyw.neocities.org"><img class="neocities-badge" src="/p/now_on_neocities.png" alt="Now on Neocities!"></a>

  <audio id="background-music" loop> <!-- Removed source tags, will set dynamically -->
    <!-- Initial source will be set by script -->
  </audio>

  <script>
    window.addEventListener('load', function() {
      const overlay = document.querySelector('.overlay');
      overlay.style.opacity = 0; // Fade out the overlay
      // Optional: Remove the overlay from the DOM after transition if it interferes
      // setTimeout(() => {
      //   if (overlay) overlay.remove();
      // }, 500); // Matches CSS transition duration
    });

    const leftImages = [
      "images/Lenored1.webp", "images/Lenored2.webp", "images/Lenored3.webp",
      "images/Lenored4.webp", "images/Lenored5.webp", "images/Lenored6.webp",
      "images/Lenored7.webp", "images/Lenored8.webp"
    ];

    const rightImages = [
      "images/Whimsicle1.webp", "images/Whimsicle2.webp"
    ];

    const leftImageElement = document.querySelector('.left-image');
    const rightImageElement = document.querySelector('.right-image');
    const musicButton = document.querySelector('.music-button');
    const musicInfo = document.querySelector('.music-info');
    const trackNameElement = document.getElementById('track-name'); // Renamed variable
    // const musicLink = document.getElementById('music-link'); // No longer directly used like this
    const backgroundMusic = document.getElementById('background-music');

    let leftIndex = 0;
    let rightIndex = 0;
    let isRightForward = true;
    let isMusicOn = false; // Initially music is off
    let currentTrackIndex = -1; // -1 means intro, 0 or 1 means loop sections
    let hasPlayedIntro = false; // Track if intro has finished

    // Define the audio tracks
    const introTrack = { src: "audio/eshopstart.mp3", trackURL: "https://youtu.be/q8FL2crrVV4", trackName: "Playing: January 2015 - Nintendo 3DS eShop" };
    const loopTracks = [
        { src: "audio/eshoploop1.mp3", trackURL: "https://youtu.be/q8FL2crrVV4", trackName: "Playing: January 2015 - Nintendo 3DS eShop" },
        { src: "audio/eshoploop2.mp3", trackURL: "https://youtu.be/xqvrIg9zrqY", trackName: "Playing: January 2015 - Nintendo 3DS eShop (SiivaGunner)" }
    ];

    // --- Image Rotation Logic ---
    setInterval(() => {
      let newIndex;
      do {
          newIndex = Math.floor(Math.random() * leftImages.length);
      } while (newIndex === leftIndex);
      leftIndex = newIndex;
      if (leftImageElement) leftImageElement.src = leftImages[leftIndex];
    }, 750);

    setInterval(() => {
      if (isRightForward) {
        rightIndex = (rightIndex + 1) % rightImages.length;
        if (rightIndex === rightImages.length - 1) isRightForward = false;
      } else {
        rightIndex = (rightIndex - 1 + rightImages.length) % rightImages.length;
        if (rightIndex === 0) isRightForward = true;
      }
      if (rightImageElement) rightImageElement.src = rightImages[rightIndex];
    }, 750);

    // --- Music Logic ---
    function setTrack(track) {
        backgroundMusic.src = track.src;
        trackNameElement.innerHTML = `<a href="${track.trackURL}" target="_blank">${track.trackName}</a>`;
    }

    function playNextLoopTrack() {
        // Randomly decide whether to play a different section (1 in 14 chance)
        const shouldPlayDifferentSection = Math.random() < (1 / 14);
        let nextTrackIndex;

        if (currentTrackIndex === -1 || loopTracks.length <= 1) {
            // If intro just played or only one loop track, just pick the first loop
            nextTrackIndex = 0;
        } else if (shouldPlayDifferentSection) {
            // Pick the *other* loop track
            nextTrackIndex = (currentTrackIndex + 1) % loopTracks.length;
        } else {
            // Keep playing the current loop track
            nextTrackIndex = currentTrackIndex;
        }

        currentTrackIndex = nextTrackIndex;
        setTrack(loopTracks[currentTrackIndex]);
        backgroundMusic.loop = true; // Loop the track section
        backgroundMusic.play().catch(error => console.log("Playback prevented:", error));
    }

    musicButton.addEventListener('click', () => {
      isMusicOn = !isMusicOn;
      musicButton.src = isMusicOn ? "images/music_on.webp" : "images/music_off.webp";

      if (isMusicOn) {
          musicInfo.style.display = "block";
          // If music was just turned on, play the intro
          if (!backgroundMusic.src || backgroundMusic.paused) {
            currentTrackIndex = -1; // Reset to intro state
            hasPlayedIntro = false;
            setTrack(introTrack);
            backgroundMusic.loop = false; // Intro doesn't loop
            backgroundMusic.play().catch(error => console.log("Playback prevented:", error));
          }
      } else {
          backgroundMusic.pause();
          musicInfo.style.display = "none";
      }
    });

    backgroundMusic.addEventListener('ended', () => {
        // This event only fires if loop=false. Use it for intro -> loop transition.
        if (isMusicOn && currentTrackIndex === -1 && !hasPlayedIntro) {
            hasPlayedIntro = true; // Mark intro as finished
            playNextLoopTrack(); // Start the first loop track
        }
        // If a loop track somehow finishes (e.g., loop=false accidentally set), restart looping logic
        else if (isMusicOn && backgroundMusic.loop === false) {
            playNextLoopTrack();
        }
    });

     // Handle potential browser autoplay restrictions
     // A common pattern is to try playing and if it fails, wait for user interaction.
     // The click handler already covers the user interaction part.

  </script>
</body>
</html>
